# Google Play 리뷰 캡처 자동화 시스템 가이드

## 📋 개요
이 시스템은 Google Play 리뷰 캡처와 HTML 리포트 자동 업데이트를 통합한 자동화 솔루션입니다.

## 🚀 설치 및 설정

### 1. 의존성 설치
```bash
pip install -r requirements_auto.txt
```

### 2. Chrome WebDriver 설치
- Chrome 브라우저가 설치되어 있어야 합니다
- WebDriver는 자동으로 다운로드됩니다 (Selenium 4.x)

## 📁 파일 구조
```
D:\aos review\
├── auto_capture_and_update.py    # 통합 자동화 스크립트
├── folder_monitor.py             # 폴더 감시 스크립트
├── run_auto_capture.bat          # Windows 배치 파일
├── 구글 플레이_리뷰.html          # HTML 리포트
├── 20250813/                     # 캡처된 이미지 폴더
├── 20250821/
└── 20250822/
```

## 🔧 사용 방법

### 방법 1: 통합 자동화 (권장)
```bash
python auto_capture_and_update.py
```
- 모든 게임을 자동으로 캡처
- HTML 파일을 자동으로 업데이트
- 한 번의 실행으로 완료

### 방법 2: Windows 스케줄러 사용
1. `run_auto_capture.bat` 파일을 더블클릭
2. Windows 작업 스케줄러에 등록하여 정기 실행

### 방법 3: 실시간 폴더 감시
```bash
python folder_monitor.py
```
- 폴더 변경을 실시간으로 감시
- 새 폴더가 생성되면 자동으로 HTML 업데이트
- 백그라운드에서 계속 실행

## ⚙️ Windows 작업 스케줄러 설정

### 1. 작업 스케줄러 열기
- Windows 키 + R → `taskschd.msc` 입력

### 2. 기본 작업 만들기
1. "기본 작업 만들기" 클릭
2. 작업 이름: "Google Play 리뷰 캡처"
3. 트리거: 매일 또는 원하는 주기
4. 동작: 프로그램 시작
5. 프로그램: `D:\aos review\run_auto_capture.bat`

### 3. 고급 설정
- "가장 높은 수준의 권한으로 실행" 체크
- 네트워크 연결이 필요할 때만 실행

## 🔄 자동화 프로세스

### 1. 캡처 단계
- 각 게임의 Google Play 페이지 접속
- "리뷰 모두 보기" 버튼 클릭
- 평점 표시 하단부터 리뷰 모두 보기까지 캡처
- YYYYMMDD 폴더에 저장

### 2. HTML 업데이트 단계
- 날짜 선택 드롭다운에 새 날짜 추가
- 통계 정보 업데이트 (캡처 일수, 총 이미지, 최근 캡처)
- 새 날짜의 콘텐츠 섹션 생성
- 전주 대비 비교 구조로 구성

### 3. 파일 구조
```
새 날짜 폴더 (예: 20250823/)
├── NewMatgo_20250823.png
├── NewMatgoKakao_20250823.png
├── Sudda_20250823.png
└── ...
```

## 🎯 주요 기능

### 자동 캡처
- 9개 게임 자동 캡처
- 리뷰 섹션 정확한 범위 설정
- 영문 파일명 사용

### HTML 자동 업데이트
- 날짜별 비교 구조
- 사업실별 그룹화 (레드/블루/브라운)
- 통계 정보 실시간 업데이트

### 오류 처리
- 네트워크 오류 시 재시도
- 캡처 실패 시 로그 기록
- HTML 업데이트 실패 시 복구

## 📊 모니터링

### 로그 확인
- 콘솔에 실시간 진행 상황 출력
- 성공/실패 상태 표시
- 처리된 파일 수 표시

### 결과 확인
- `구글 플레이_리뷰.html` 파일 열기
- 새 날짜 선택하여 결과 확인
- 이미지 클릭하여 확대 보기

## 🔧 문제 해결

### 일반적인 문제
1. **Chrome WebDriver 오류**
   - Chrome 브라우저 업데이트
   - Selenium 재설치

2. **캡처 실패**
   - 네트워크 연결 확인
   - Google Play 페이지 접근 가능 여부 확인

3. **HTML 업데이트 실패**
   - 파일 권한 확인
   - HTML 파일 백업 후 재시도

### 로그 분석
```bash
# 상세 로그 확인
python auto_capture_and_update.py > log.txt 2>&1
```

## 📞 지원
- 문제 발생 시 로그 파일과 함께 문의
- 정기적인 백업 권장
- 네트워크 환경 안정성 확인



